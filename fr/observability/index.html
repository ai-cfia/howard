
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Documentation d'implémentation pour la solution d'observabilité - Howard</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#documentation-dimplementation-pour-la-solution-dobservabilite" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-tête">
    <a href=".." title="Howard" class="md-header__button md-logo" aria-label="Howard" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Howard
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Documentation d'implémentation pour la solution d'observabilité
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Sélectionner la langue">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="/howard/en/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="/howard/fr/" hreflang="fr" class="md-select__link">
              French
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ai-cfia/howard" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ai-cfia/howard
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Howard" class="md-nav__button md-logo" aria-label="Howard" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Howard
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ai-cfia/howard" title="Aller au dépôt" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ai-cfia/howard
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accueil
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../adr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ADR
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration / Implémentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Github workflow
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table des matières">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des matières
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#vue-densemble" class="md-nav__link">
    <span class="md-ellipsis">
      Vue d'ensemble
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fonctionnement-de-grafana-alloy" class="md-nav__link">
    <span class="md-ellipsis">
      Fonctionnement de Grafana Alloy
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-de-grafana-alloy" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration de Grafana Alloy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration de Grafana Alloy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explication-de-la-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Explication de la configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exposition-des-services-alloy" class="md-nav__link">
    <span class="md-ellipsis">
      Exposition des services Alloy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instrumentation-des-metriques-journaux-et-traces" class="md-nav__link">
    <span class="md-ellipsis">
      Instrumentation des métriques, journaux et traces
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transmission-des-donnees-a-loki-tempo-et-prometheus" class="md-nav__link">
    <span class="md-ellipsis">
      Transmission des données à Loki, Tempo et Prometheus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#utilisation-de-grafana-pour-la-visualisation" class="md-nav__link">
    <span class="md-ellipsis">
      Utilisation de Grafana pour la visualisation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utilisation de Grafana pour la visualisation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuration-de-grafana" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration de Grafana
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creation-de-tableaux-de-bord" class="md-nav__link">
    <span class="md-ellipsis">
      Création de tableaux de bord
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tableaux-de-bord-actuels" class="md-nav__link">
    <span class="md-ellipsis">
      Tableaux de bord actuels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mises-a-jour-futures" class="md-nav__link">
    <span class="md-ellipsis">
      Mises à jour futures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      Références
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="documentation-dimplementation-pour-la-solution-dobservabilite">Documentation d'implémentation pour la solution d'observabilité</h1>
<h2 id="vue-densemble">Vue d'ensemble</h2>
<p>Cette documentation explique l'implémentation de notre pile d'observabilité en
utilisant OpenTelemetry, Grafana Alloy, Loki, Tempo et Prometheus. Cette pile
fournit une surveillance et une observabilité complètes pour nos applications
hébergées sur Azure Kubernetes Service (AKS).</p>
<h2 id="fonctionnement-de-grafana-alloy">Fonctionnement de Grafana Alloy</h2>
<p>Grafana Alloy agit comme le collecteur principal d'OpenTelemetry, agrégeant les
métriques, les journaux et les traces de diverses sources. Il traite les données
collectées et les transmet à Loki, Tempo et Prometheus pour le stockage et la
requête.</p>
<h2 id="configuration-de-grafana-alloy">Configuration de Grafana Alloy</h2>
<p>La configuration détaillée de Grafana Alloy est disponible à partir de :
<a href="https://github.com/ai-cfia/howard/blob/d8964d58ad42808b97c5cccc8ee7aaf8fab69b63/kubernetes/aks/system/monitoring/helm/alloy-values.yaml#L28">alloy-values.yaml</a>.</p>
<h3 id="explication-de-la-configuration">Explication de la configuration</h3>
<ul>
<li><strong>otelcol.exporter.otlp</strong> : Configure l'exportateur OTLP pour envoyer des
  données aux points de terminaison spécifiés.</li>
<li><strong>otelcol.receiver.otlp</strong> : Configure les récepteurs OTLP pour les protocoles
  gRPC et HTTP, définissant comment les métriques, les journaux et les traces
  sont reçus et transmis.</li>
<li><strong>otelcol.processor.memory_limiter</strong> : Implémente un limiteur de mémoire pour
  contrôler l'utilisation de la mémoire, assurant la stabilité.</li>
<li><strong>otelcol.processor.batch</strong> : Regroupe les données de télémétrie avant de les
  transmettre pour améliorer les performances et l'efficacité.</li>
<li><strong>logging</strong> : Configure le niveau et le format des journaux pour le dépannage
  et la surveillance du fonctionnement d'Alloy.</li>
<li><strong>otelcol.exporter.loki</strong> : Configure l'exportateur pour envoyer des journaux
  à Loki.</li>
<li><strong>loki.write</strong> : Définit le point de terminaison pour l'envoi des journaux à
  Loki.</li>
<li><strong>otelcol.exporter.otlp</strong> : Configure l'exportateur pour envoyer des traces à
  Tempo.</li>
<li><strong>otelcol.exporter.prometheus</strong> : Configure l'exportateur pour envoyer des
  métriques à Prometheus.</li>
<li><strong>prometheus.remote_write</strong> : Définit le point de terminaison pour l'envoi des
  métriques à Prometheus.</li>
</ul>
<h3 id="exposition-des-services-alloy">Exposition des services Alloy</h3>
<p>Les ports de service suivants exposent Alloy, le rendant accessible au sein du
cluster Kubernetes :</p>
<div class="highlight"><pre><span></span><code><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;grpc&quot;</span>
<span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4317</span>
<span class="w">  </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4317</span>
<span class="w">  </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TCP&quot;</span>
<span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http&quot;</span>
<span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4318</span>
<span class="w">  </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4318</span>
<span class="w">  </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TCP&quot;</span>
</code></pre></div>
<p>Accessible via : alloy.monitoring.svc.cluster.local</p>
<h2 id="instrumentation-des-metriques-journaux-et-traces">Instrumentation des métriques, journaux et traces</h2>
<p>Pour envoyer des métriques, des journaux et des traces à Grafana Alloy,
configurez vos applications pour utiliser les SDK OpenTelemetry et définissez le
point de terminaison sur alloy.monitoring.svc.cluster.local.</p>
<p>Exemple pour les métriques</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">opentelemetry</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">opentelemetry.sdk.metrics</span> <span class="kn">import</span> <span class="n">MeterProvider</span>
<span class="kn">from</span> <span class="nn">opentelemetry.exporter.otlp.proto.grpc.metric_exporter</span> <span class="kn">import</span> <span class="n">OtlpExporter</span>

<span class="n">metrics</span><span class="o">.</span><span class="n">set_meter_provider</span><span class="p">(</span><span class="n">MeterProvider</span><span class="p">())</span>
<span class="n">meter</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">get_meter</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">exporter</span> <span class="o">=</span> <span class="n">OtlpExporter</span><span class="p">(</span><span class="n">endpoint</span><span class="o">=</span><span class="s2">&quot;alloy.monitoring.svc.cluster.local:4317&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Exemple pour les journaux</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">opentelemetry</span> <span class="kn">import</span> <span class="n">logs</span>
<span class="kn">from</span> <span class="nn">opentelemetry.sdk.logs</span> <span class="kn">import</span> <span class="n">LogEmitterProvider</span>
<span class="kn">from</span> <span class="nn">opentelemetry.exporter.otlp.proto.grpc.log_exporter</span> <span class="kn">import</span> <span class="n">OtlpExporter</span>

<span class="n">logs</span><span class="o">.</span><span class="n">set_log_emitter_provider</span><span class="p">(</span><span class="n">LogEmitterProvider</span><span class="p">())</span>
<span class="n">emitter</span> <span class="o">=</span> <span class="n">logs</span><span class="o">.</span><span class="n">get_log_emitter</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">exporter</span> <span class="o">=</span> <span class="n">OtlpExporter</span><span class="p">(</span><span class="n">endpoint</span><span class="o">=</span><span class="s2">&quot;alloy.monitoring.svc.cluster.local:4317&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Exemple pour les traces</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">opentelemetry</span> <span class="kn">import</span> <span class="n">trace</span>
<span class="kn">from</span> <span class="nn">opentelemetry.sdk.trace</span> <span class="kn">import</span> <span class="n">TracerProvider</span>
<span class="kn">from</span> <span class="nn">opentelemetry.exporter.otlp.proto.grpc.trace_exporter</span> <span class="kn">import</span> <span class="n">OtlpExporter</span>

<span class="n">trace</span><span class="o">.</span><span class="n">set_tracer_provider</span><span class="p">(</span><span class="n">TracerProvider</span><span class="p">())</span>
<span class="n">tracer</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">get_tracer</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">exporter</span> <span class="o">=</span> <span class="n">OtlpExporter</span><span class="p">(</span><span class="n">endpoint</span><span class="o">=</span><span class="s2">&quot;alloy.monitoring.svc.cluster.local:4317&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="transmission-des-donnees-a-loki-tempo-et-prometheus">Transmission des données à Loki, Tempo et Prometheus</h2>
<p>Grafana Alloy traite et transmet les données reçues aux backends respectifs.</p>
<ul>
<li>Les journaux sont transmis à Loki à
  <code>http://loki.monitoring.svc.cluster.local:3100/loki/api/v1/push</code></li>
<li>Les traces sont transmises à Tempo à
  <code>http://tempo.monitoring.svc.cluster.local:4317</code></li>
<li>Les métriques sont transmises à Prometheus à
  <code>http://kube-prometheus-stack-prometheus.monitoring.svc.cluster.local:9090/api/v1/write</code></li>
</ul>
<h2 id="utilisation-de-grafana-pour-la-visualisation">Utilisation de Grafana pour la visualisation</h2>
<p>Grafana est disponible à <a href="https://grafana.inspection.alpha.canada.ca">https://grafana.inspection.alpha.canada.ca</a>. L'accès
est accordé via l'organisation GitHub de l'agence.</p>
<h3 id="configuration-de-grafana">Configuration de Grafana</h3>
<ol>
<li>Connectez-vous à Grafana en utilisant vos identifiants GitHub.</li>
<li>Naviguez vers les Tableaux de bord pour explorer différents répertoires tels
que admin, devsecops, finesse, et nachet.</li>
<li>Utilisez l'une des trois sources de données :<ul>
<li>Prometheus pour les métriques Loki pour les journaux</li>
<li>Tempo pour les traces</li>
</ul>
</li>
</ol>
<h3 id="creation-de-tableaux-de-bord">Création de tableaux de bord</h3>
<ol>
<li>Allez à Tableaux de bord &gt; Nouveau tableau de bord.</li>
<li>Sélectionnez la source de données (Prometheus, Loki ou Tempo).</li>
<li>Créez des visualisations et configurez les panneaux selon vos besoins.</li>
</ol>
<h3 id="tableaux-de-bord-actuels">Tableaux de bord actuels</h3>
<p>La plupart des tableaux de bord se trouvent dans le dossier devsecops, y
compris:
    - Surveillance de la santé des nœuds
    - Activité ArgoCD
    - Trafic Ingress-NGINX
    - Scans de vulnérabilités par Trivy et Falco</p>
<h3 id="mises-a-jour-futures">Mises à jour futures</h3>
<p>Cette documentation sera mise à jour au fur et à mesure que nous incorporerons
des tableaux de bord pour des applications clientes telles que Fertiscan,
Finesse et Nachet.</p>
<h2 id="references">Références</h2>
<ul>
<li><a href="https://opentelemetry.io/docs/">Documentation OpenTelemetry</a></li>
<li><a href="https://opentelemetry.io/docs/languages/python/">SDK Python OpenTelemetry</a></li>
<li><a href="https://grafana.com/docs/grafana/latest/">Documentation Grafana</a></li>
<li><a href="https://prometheus.io/docs/">Documentation Prometheus</a></li>
<li><a href="https://grafana.com/docs/loki/latest/">Documentation Loki</a></li>
<li><a href="https://grafana.com/docs/tempo/latest/">Documentation Tempo</a></li>
<li><a href="https://grafana.com/docs/alloy/latest/">Documentation Grafana Alloy</a></li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "header.autohide"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>